<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="collective.abcmusic">

<head>
<metal:js fill-slot="javascript_head_slot">
	<script type="text/javascript" tal:attributes="src string:${portal_url}/++resource++collective.js.abcjs/abcjs_plugin_1.4.user.js"></script>
<!--
	<script type="text/javascript" tal:attributes="src string:${portal_url}/++resource++collective.abcmusic/js/abcmusic-tuneView.js"></script>
-->
</metal:js>
</head>

<body>
<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main">
    <button id="toggleHeaders" i18n:translate="">&nbsp;&nbsp;&nbsp;hide/show top&nbsp;&nbsp;&nbsp;</button>
    &nbsp;&nbsp;&nbsp;
    <button id="toggleABCTextarea" i18n:translate="">&nbsp;&nbsp;&nbsp;hide/show abcTextarea&nbsp;&nbsp;&nbsp;</button>
	<div id="accordion">
	
	<h3 i18n:translate="">inline editing</h3>
	<div>
    <div id="avertissementTuneModified"></div>
    <div id="tuneNotModified">&nbsp;</div>
    
    <div id="tuneModified">
       <span i18n:translate="">The tune is modified, you should save it if you want to keep your work : </span>
       <button id="saveModifications" i18n:translate="">Save</button>
    </div>
    
<span tal:replace="nothing">
       <form  action="">
       <input id="XsaveModifications" type="submit" value="save" i18n:domain="plone" i18n:attributes="value label_save;"/>
    </form>
</span>

    <p />
	<table border="0">
	<tbody>
    <tr class="speed-slider">
		<td width="60px" i18n:translate="speed : ">speed : </td>
		<td>
			<div id="slider" type="slider" />
		</td>
		<td width="40px">
			<span id="slider-value"></span>
		</td>
	</tr>
    
    <tr>
	    <td colspan="3">
	    	<textarea id="abc-text" cols="100" rows="18" tal:content="structure string:${here/abc}"/>
	    </td>
    </tr>
	<tr>
		<td colspan="3">
			<div id="midi-edit">midi</div>
		</td>
	</tr>
	<tr>
	<td colspan = "2">
    	<div id="abc-edit">score</div>
    </td>
	    <td>
	        <span id="abcscale">abcscale</span>
	    	<div id="abc-edit-slider-size"></div>
	    </td>
    </tr>

	</tbody>
	</table>
</div>
<h3 i18n:translate="">view the tune as it is stored in the database</h3>
<div>
    <!-- cf : http://webdesign.about.com/od/sound/ht/htsound.htm  -->
    <object id="midiView" tal:define="midi nocall:context/midi"
            tal:condition="nocall:midi">
            <embed id="abctuneMidi" height="30" autostart="false" controller="true" autoplay="true" src=""
                   tal:attributes="src string:${context/absolute_url}/@@download/midi/${midi/filename}"
                   type="audio/mid">
            </embed>
    </object>

    <div tal:define="pdfscore nocall:context/pdfscore"
             tal:condition="nocall:pdfscore">
            <a id="abctunePDFScore" tal:attributes="href string:${context/absolute_url}/@@download/pdfscore/${pdfscore/filename}; target string:_blank;">PDF</a>
        </div>

    <div id="scoreView" tal:define="score nocall:context/score"
             tal:condition="nocall:score">
            <img id="abctuneScore" tal:attributes="src string:${context/absolute_url}/@@download/score/${score/filename};
                                 height score/_height | nothing;
                                 width score/_width | nothing;"
                />
        </div>
</div>
</div>
<script type="text/javascript"> 
jq("#toggleHeaders").click(function(){
	jq("#portal-top").toggle("fast");
	jq("#viewlet-above-content").toggle("fast");
	jq("#edit-bar").toggle("fast");
});
jq("#toggleABCTextarea").click(function(){
	jq("#abc-text").toggle("fast");
});

</script>

    </tal:main-macro>
</metal:main>


</body>
</html>
    
